<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Packages – Markup Languages and Reproducible Programming in Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./story.html" rel="next">
<link href="./week 5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week 6.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Markup Languages and Reproducible Programming in Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/gerkovink/markup" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface and schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching team</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deliverables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deliverables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GenAI rules</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Markup Languages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Version Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Developer Portfolios</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week 6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./story.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contributors</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#real-title-packages-code-robustness-and-unit-testing" id="toc-real-title-packages-code-robustness-and-unit-testing" class="nav-link active" data-scroll-target="#real-title-packages-code-robustness-and-unit-testing"><span class="header-section-number">6.1</span> Real title: Packages, Code Robustness and Unit Testing</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages"><span class="header-section-number">6.2</span> <code>R</code> packages</a>
  <ul class="collapse">
  <li><a href="#recap-on-git" id="toc-recap-on-git" class="nav-link" data-scroll-target="#recap-on-git"><span class="header-section-number">6.2.1</span> Recap on <code>Git</code></a></li>
  <li><a href="#why-github" id="toc-why-github" class="nav-link" data-scroll-target="#why-github"><span class="header-section-number">6.2.2</span> Why GitHub</a></li>
  <li><a href="#install-rstudio" id="toc-install-rstudio" class="nav-link" data-scroll-target="#install-rstudio"><span class="header-section-number">6.2.3</span> Install <code>RStudio</code></a></li>
  </ul></li>
  <li><a href="#some-r-code" id="toc-some-r-code" class="nav-link" data-scroll-target="#some-r-code"><span class="header-section-number">6.3</span> Some R-code</a></li>
  <li><a href="#create-r-package-roundr" id="toc-create-r-package-roundr" class="nav-link" data-scroll-target="#create-r-package-roundr"><span class="header-section-number">6.4</span> Create <code>R</code>-package <code>roundR</code></a>
  <ul class="collapse">
  <li><a href="#steps-in-creating-an-r-package" id="toc-steps-in-creating-an-r-package" class="nav-link" data-scroll-target="#steps-in-creating-an-r-package"><span class="header-section-number">6.4.1</span> Steps in creating an <code>R</code>-package</a></li>
  </ul></li>
  <li><a href="#installing-your-own-package-from-github" id="toc-installing-your-own-package-from-github" class="nav-link" data-scroll-target="#installing-your-own-package-from-github"><span class="header-section-number">6.5</span> Installing your own package from GitHub</a></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics"><span class="header-section-number">6.6</span> Advanced topics</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gerkovink/markup/edit/book/week 6.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gerkovink/markup/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-wk6" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="real-title-packages-code-robustness-and-unit-testing" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="real-title-packages-code-robustness-and-unit-testing"><span class="header-section-number">6.1</span> Real title: Packages, Code Robustness and Unit Testing</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lecture Week 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>We discussed the flow of creating <a href="https://r-pkgs.org/"><code>R</code> packages</a> and <a href="https://shiny.posit.co"><code>Shiny</code> apps</a>. Along the way, we touched upon the importance of version control, testing and documentation. A static version of Hanne’s Shiny slides <a href="slides/lec-shiny.pdf">can be found here</a>.</p>
<p>You can join the Teams during the lecture (for screen sharing) <a href="https://teams.microsoft.com/l/meetup-join/19%3ameeting_NTEzYzYxYTItNWE3NS00YTczLTg5MGEtMmY4YTM5NGI4Mjg2%40thread.v2/0?context=%7b%22Tid%22%3a%22d72758a0-a446-4e0f-a0aa-4bf95a4a10e7%22%2c%22Oid%22%3a%22cc7d7fcd-73aa-4668-936a-2ca38cace0f3%22%7d">here</a> and see the recording of the R-package creation in the above teams link after class or see last year’s recording <a href="https://www.dropbox.com/scl/fi/hscfsrh30slk23k7z6d1d/wk6_recording.mp4?rlkey=yhy7wt8ldfmsybbb3000z1hl0&amp;dl=0">here</a> (download for the 1h+ recording)</p>
</div>
</div>
</section>
<section id="r-packages" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="r-packages"><span class="header-section-number">6.2</span> <code>R</code> packages</h2>
<p>It is much easier to create, manage and co-develop an <code>R</code> package when you incorporate it into a distributed version control system like <a href="https://git-scm.com">Git</a>. The extension to a software development hosting service like <a href="https://github.com">GitHub</a> is then a natural one. Although there are other procedures, devops systems and hosting services that may lend itself for package development, we outline the workflow with <code>Git</code> and <code>GitHub</code>. We also assume that you have <a href="https://posit.co/products/open-source/rstudio/"><code>RStudio</code></a> installed.</p>
<section id="recap-on-git" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="recap-on-git"><span class="header-section-number">6.2.1</span> Recap on <code>Git</code></h3>
<p><code>Git</code> is a free and open source version control system for text files. It can handle extensive change logging for you, no matter the size of the project. <code>Git</code> is fast and efficient, but its effectiveness depends also on the frequency you instruct it to log your project’s changes.</p>
<p>You can see <code>Git</code> as a blank canvas that starts at a certain point in time. Every time you (or others) instruct <code>Git</code> to log any changes that have been made, <code>Git</code> adds the changes that are made to this canvas. We call the changes to the canvas <a href="https://help.github.com/articles/github-glossary/#commit"><code>commits</code></a>. With every <code>commit</code> an extensive log is created that includes at least the following information:</p>
<ul>
<li>the changes made</li>
<li>who made the changes</li>
<li>metadata</li>
<li>a small piece of text that describe the changes made</li>
</ul>
<p>The difference between two commits - or the changes between them - are called <a href="https://help.github.com/articles/github-glossary/#diff"><code>diffs</code></a>.</p>
<p>If you’d like to know much more about <code>Git</code>, <a href="https://git-scm.com/book/en/v2">this online book</a> is a very good resource. If you’d like to practice with the command line interface <a href="https://learngitbranching.js.org">use this webpage</a> for a quick course. <a href="https://happygitwithr.com">This book</a> covers pretty much everything you need to marry <code>Git</code> and <code>R</code>.</p>
</section>
<section id="why-github" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="why-github"><span class="header-section-number">6.2.2</span> Why GitHub</h3>
<p><code>GitHub</code> is the social and user interface to <code>Git</code> that allows you to work in <a href="https://help.github.com/articles/github-glossary/#repository">repositories</a>. These repositories can be seen as project folders in which you publish your work, but you can also use them as test sites for development, testing, etcetera. There is a distinction between <a href="https://help.github.com/articles/github-glossary/#private-repository">private repositories</a> (only for you and those you grant access) and public repositories (visible for everyone).</p>
<p>Your public repositories can be viewed and <a href="https://help.github.com/articles/github-glossary/#fork">forked</a> by everyone. <code>Forking</code> is when other people create a copy of your repository on their own account. This allows them to work on a repository without affecting the <code>master</code>. You can also do this yourself, but then the process is called <a href="https://help.github.com/articles/github-glossary/#branch"><code>branching</code></a> instead of forking. If you create a copy of a repository that is offline, the process is called <a href="https://help.github.com/articles/github-glossary/#clone"><code>cloning</code></a>.</p>
<p><code>GitHub</code>’s ability to branch, fork and clone is very useful as it allows other people and yourself to experiment on (the code in) a repository before any definitive changes are <a href="https://help.github.com/articles/github-glossary/#merge"><code>merged</code></a> with the <code>master</code>. If you’re working in a forked repository, you can submit a <a href="https://help.github.com/articles/github-glossary/#pull-request"><code>pull request</code></a> to the repository collaborators to accept (or reject) any suggested changes.</p>
<p>For now, this may be confusing, but I hope you recognize the benefits <code>GitHub</code> can have on the process of development and bug-fixing. For example, the most up-to-date version of the <code>mice</code> package in <code>R</code> can be directly installed from the <code>mice</code> repository with the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo =</span> <span class="st">"stefvanbuuren/mice"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see that this process requires package <code>devtools</code> that expands the <code>R</code> functionality with essential development tools. Loading packages in <code>R</code> directly from their respective <code>GitHub</code> repositories, allows you to obtain the latest - often improved and less buggy - iteration of that software even before it is published on <a href="https://cran.r-project.org"><code>CRAN</code></a>.</p>
</section>
<section id="install-rstudio" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="install-rstudio"><span class="header-section-number">6.2.3</span> Install <code>RStudio</code></h3>
<p>Install <code>RStudio</code> from <a href="https://posit.co/products/open-source/rstudio/">Posit’s website</a>. The free edition will suffice.</p>
</section>
</section>
<section id="some-r-code" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="some-r-code"><span class="header-section-number">6.3</span> Some R-code</h2>
<p>In order to demonstrate the creation of an R-package, we will identify some odd behaviour by <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 2 2 4</code></pre>
</div>
</div>
<p>We can see that <code>R</code> rounds - by default - the number <code>1.5</code> to integer <code>2</code> and the number <code>2.5</code> also to integer <code>2</code>. The reason for this behaviour is the IEC 60559 standard where a 5 is expected to be rounded to the even digit.</p>
<p>If we’d like to round up to the next integer, we can easily define the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rounder <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">floor</span>(x)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  out[diff <span class="sc">&lt;</span> .<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">floor</span>(x)[diff <span class="sc">&lt;</span> .<span class="dv">5</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the vector <code>c(0.5, 1.5, 2.5, 3.5)</code> is rounded up to the <em>next</em> integer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
</div>
<p>and where the vector <code>c(0.49, 1.49, 2.49, 3.49)</code> is rounded down to the <em>previous</em> integer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">0.49</span>, <span class="fl">1.49</span>, <span class="fl">2.49</span>, <span class="fl">3.49</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 1 2 3</code></pre>
</div>
</div>
</section>
<section id="create-r-package-roundr" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="create-r-package-roundr"><span class="header-section-number">6.4</span> Create <code>R</code>-package <code>roundR</code></h2>
<p>The goal of this document is to create the code for the <code>rounder()</code> function into a stand-alone <code>R</code>-package with its referable <a href="https://www.doi.org">Digital Object Identifier</a></p>
<section id="steps-in-creating-an-r-package" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="steps-in-creating-an-r-package"><span class="header-section-number">6.4.1</span> Steps in creating an <code>R</code>-package</h3>
<section id="packages-and-sources-needed" class="level4" data-number="6.4.1.1">
<h4 data-number="6.4.1.1" class="anchored" data-anchor-id="packages-and-sources-needed"><span class="header-section-number">6.4.1.1</span> Packages and sources needed</h4>
<p>We need the following packages to help us with building, testing and maintaining our package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools) <span class="co"># development tools</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)  <span class="co"># automated package and project setup</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat) <span class="co"># unit testing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-the-package-structure" class="level4" data-number="6.4.1.2">
<h4 data-number="6.4.1.2" class="anchored" data-anchor-id="preparing-the-package-structure"><span class="header-section-number">6.4.1.2</span> Preparing the package structure</h4>
<p>We need a location for our <code>R</code>-package. The simplest approach to creating the skeleton for an <code>R</code>-package is to use <code>RStudio</code>. The following gif outlines this procedure:</p>
<center>
<img src="images/wk6/packagefolder.gif" class="img-fluid" style="width:90.0%">
</center>
<p>We have now created the necessary structure for an <code>R</code>-package. We can see this structure and the generated package files in the <code>File Pane</code> in <code>RStudio</code>.</p>
<center>
<img src="images/wk6/filepane.png" class="img-fluid" style="width:90.0%">
</center>
<p>The <code>R</code> subfolder contains all the <code>R</code>-code for your package and the <code>man</code> folder contains all the corresponding <code>R</code> manuals. By default, for a new <code>R</code>-package generated by <code>RStudio</code> the file <code>hello.R</code> is generated.</p>
<center>
<img src="images/wk6/hellofile.png" class="img-fluid" style="width:90.0%">
</center>
<p>As a matter of fact, the skeleton <code>R</code>-package is already a fully functional <code>R</code>-package. Try installing the package in the <code>build</code> pane.</p>
<center>
<img src="images/wk6/build.gif" class="img-fluid" style="width:90.0%">
</center>
</section>
<section id="add-the-description" class="level4" data-number="6.4.1.3">
<h4 data-number="6.4.1.3" class="anchored" data-anchor-id="add-the-description"><span class="header-section-number">6.4.1.3</span> Add the description</h4>
<p>Open the file <code>DESCRIPTION</code> from the file pane. The following window opens:</p>
<center>
<img src="images/wk6/DESCRIPTION.png" class="img-fluid" style="width:90.0%">
</center>
<p><br></p>
<p>Now, replace the contents of the <code>DESCRIPTION</code> file with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Package<span class="sc">:</span> roundR</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Type<span class="sc">:</span> Package</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Title<span class="sc">:</span> Round Numeric Values to the Nearest Integer</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Version<span class="sc">:</span> <span class="dv">0</span>.<span class="fl">1.0</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Author<span class="sc">:</span> Gerko Vink and Hanne Oberman</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>Maintainer<span class="sc">:</span> Gerko Vink <span class="sc">&lt;</span>G.Vink<span class="sc">@</span>uu.nl<span class="sc">&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>Description<span class="sc">:</span> In R the default choice <span class="cf">for</span> rounding follows the IEC <span class="dv">60559</span> standard where a <span class="dv">5</span> is expected to be rounded to the even digit. This package offers alternative functionality to round to the closest integer. </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>License<span class="sc">:</span> No LiCeNsE YeT</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>Encoding<span class="sc">:</span> UTF<span class="dv">-8</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>LazyData<span class="sc">:</span> true</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>DESCRIPTION</code> file governs the information about the licence, authors, contributors, maintainers, etcetera. The argument <code>lazyData: true</code> indicates that data sets should be lazily loaded. This means that data will not occupy any memory unless it is needed. This is a good argument to have as default.</p>
<p>We also need to set a license. Running the following code from package <code>usethis</code> will write a permissive MIT license to the description file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_mit_license</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Don’t forget to save the updated DESCRIPTION file and change our names to your name.</p>
</section>
<section id="add-the-functional-code" class="level4" data-number="6.4.1.4">
<h4 data-number="6.4.1.4" class="anchored" data-anchor-id="add-the-functional-code"><span class="header-section-number">6.4.1.4</span> Add the functional code</h4>
<p>Now it is time to extend the package with the functionality we promised in our updated <code>DESCRIPTION</code>. To do so, we start a new file names <code>rounder.R</code> by either manually creating it in the <code>R</code> sub folder, or by running the following code evaluation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_r</span>(<span class="st">"rounder"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>use_r()</code> function from the <code>usethis</code> package is very convenient, because it creates the necessary file in the correct location and opens the file in the editor pane.</p>
<center>
<img src="images/wk6/use_r.gif" class="img-fluid" style="width:90.0%">
</center>
<p><br></p>
<p>Now that we have created the file for our functional code, we can start building the code file. The most flexible approach to creating and maintaining a package is to use <code>roxygen2</code>. The <code>roxygen2</code> package is a convenient in-line documentation convention that generates your <code>Rd</code> documentation, <code>NAMESPACE</code> file, and much more for you. Remember that <code>man</code> folder in our package root? That contains all documentation files. However, you can imagine if we have two seperate locations for our <code>R</code>-code and our <code>Rd</code> help files, that at some point the code and documentation might get out of sync. For example, if we update the code, but forget to reflect changes in our manual, the usability of our package may be at stake and documentation to end-users might get confusing. Most of all, it would be a lot of work for us to maintain multiple linked files in multiple locations. <code>roxygen2</code> solves this for us by extracting the documentation from our <code>R</code>-code file. The only thing we need to do is maintain a single file.</p>
<p>To start with <code>roxygen2</code> in our package, we need to instruct the package to use <code>roxygen2</code> from now on:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_roxygen_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above call will add the following lines to our <code>DESCRIPTION</code> file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Roxygen<span class="sc">:</span> <span class="fu">list</span>(<span class="at">markdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>RoxygenNote<span class="sc">:</span> <span class="dv">7</span>.<span class="fl">3.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We mentioned before that the <code>roxygen2</code> engine expects the function documentation in the same file as the function code. A good starting point for that documentation is the following block:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' A short description of your function</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x The first argument to be governed by the letter x.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param y The second argument to denoted by the letter y.</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @returns a short description of the expected return.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' examplecode 1</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' examplecode 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <code>R</code>, when you have executed <code>usethis::use_r()</code> and have filled in your <code>R</code> code, you can run <code>Code &gt; Insert Roxygen Skeleton</code> to automatically create the relevant roxygen documentation. For our function <code>rounder()</code> - with some customization and examples, this could result in the following <code>rounder.R</code> code file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Round to the nearest integer</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'Function \code{\link{base::round}} rounds - by default -  the number `1.5` to</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'integer `2` and the number `2.5` also to integer `2`. The reason for this</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'behaviour is the IEC 60559 standard where a 5 is expected to be rounded to the</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'even digit. This function provides an integer rounding alternative to</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'\code{\link{base::round}}.</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x A numeric element or vector to round to the nearest integer</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @returns An integer element or vector</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#' @author Gerko Vink \email{g.vink@uu.nl} and Hanne Oberman \email{h.i.oberman@uu.nl}</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' # rounds weirdly</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' c(0.5, 1.5, 2.5, 3.5) %&gt;% round()</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' # rounds correctly</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#' c(0.5, 1.5, 2.5, 3.5) %&gt;% rounder()</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>rounder <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">floor</span>(x)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  out[diff <span class="sc">&lt;</span> .<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">floor</span>(x)[diff <span class="sc">&lt;</span> .<span class="dv">5</span>]</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can copy the above code chunk to your <code>rounder.R</code> file. A good source to find inspiration for writing <code>roxygen2</code> documentation is <a href="https://roxygen2.r-lib.org/articles/roxygen2.html">the <code>roxygen2</code> reference page</a>.</p>
<p>Now that we have a working <code>rounder.R</code> file with documentation included, we can build the documentation. A good wrapper function to build all documentation in your package is the following code evaluation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">document</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<center>
<img src="images/wk6/devtools.gif" class="img-fluid" style="width:90.0%">
</center>
<p><br></p>
<p>The <code>document()</code> function from the <code>devtools</code> package will build all documentation for all files that use <code>roxygen2</code> and it will build the <code>NAMESPACE</code> of your package accordingly. If you encounter the following message:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Skipping NAMESPACE</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>✖ It already exists and was not generated by roxygen2. </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>just remove the <code>NAMESPACE</code> file and re-run the <code>document()</code> function.</p>
<p>We can now remove the <code>R/hello.R</code> and <code>man/hello.Rd</code> files as they are not supposed to be part of our package</p>
</section>
<section id="building-and-checking" class="level4" data-number="6.4.1.5">
<h4 data-number="6.4.1.5" class="anchored" data-anchor-id="building-and-checking"><span class="header-section-number">6.4.1.5</span> Building and checking</h4>
<p>Let’s check the functionality of our package.</p>
<center>
<img src="images/wk6/check.gif" class="img-fluid" style="width:90.0%">
</center>
<p><br></p>
<p>We can see under <code>build &gt; check</code> that our current package yields 1 error, 1 warning and 1 note.</p>
<section id="error" class="level5" data-number="6.4.1.5.1">
<h5 data-number="6.4.1.5.1" class="anchored" data-anchor-id="error"><span class="header-section-number">6.4.1.5.1</span> Error</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>❯ checking examples ... ERROR</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  Running examples <span class="cf">in</span> ‘roundR<span class="sc">-</span>Ex.R’ failed</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  The error most likely occurred <span class="cf">in</span><span class="sc">:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>() <span class="sc">:</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    could not find <span class="cf">function</span> <span class="st">"%&gt;%"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  Execution halted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The error stems from the examples in our documentation. The examples use the binary function <code>%&gt;%</code> from package <code>magrittr</code>, but we did not load that package in the example. Remember that these examples are self-contained and that any dependent packages need to be explicitly loaded via <code>library()</code> for the code to run. Just like any other <code>R</code> instance. Simply adding <code>library(magrittr)</code> to the example code will solve the issue.</p>
<p>Add <code>library(magrittr)</code> to the example code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' library(magrittr)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' # rounds weirdly</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' c(0.5, 1.5, 2.5, 3.5) %&gt;% round()</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' # rounds correctly</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' c(0.5, 1.5, 2.5, 3.5) %&gt;% rounder()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="warning" class="level5" data-number="6.4.1.5.2">
<h5 data-number="6.4.1.5.2" class="anchored" data-anchor-id="warning"><span class="header-section-number">6.4.1.5.2</span> Warning</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>❯ checking Rd cross<span class="sc">-</span>references ... WARNING</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  Missing link or links <span class="cf">in</span> documentation object <span class="st">'rounder.Rd'</span><span class="sc">:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    ‘base<span class="sc">::</span>round’</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  See section <span class="st">'Cross-references'</span> <span class="cf">in</span> the <span class="st">'Writing R Extensions'</span> manual.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The error stems from the crossreference we attempted in our documentation. The proper way to refer to function <code>round()</code> from package <code>base</code> is not with <code>\link{base::round}</code>, but with <code>\link[base]{round}</code> following the structure <code>\link[package]{function}</code>. We could have opted for not referencing, or linking the <code>round()</code> function at all, but this would not align with open and inclusive development conventions.</p>
<p>Correct the faulty crossreferences in the documentation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#'Function \code{\link[base]{round}} rounds - by default -  the number `1.5` to</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'integer `2` and the number `2.5` also to integer `2`. The reason for this</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'behaviour is the IEC 60559 standard where a 5 is expected to be rounded to the</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'even digit. This function provides an integer rounding alternative to</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'\code{\link[base]{round}}.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="note" class="level5" data-number="6.4.1.5.3">
<h5 data-number="6.4.1.5.3" class="anchored" data-anchor-id="note"><span class="header-section-number">6.4.1.5.3</span> Note</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>❯ checking R code <span class="cf">for</span> possible problems ... NOTE</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  rounder<span class="sc">:</span> no visible global <span class="cf">function</span> definition <span class="cf">for</span> ‘<span class="sc">%&gt;%</span>’</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  Undefined global functions or variables<span class="sc">:</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">%&gt;%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We use function <code>%&gt;%</code> from package <code>magrittr</code>, but we neglected to make explicit that this function should have been imported from package <code>magrittr</code>. In other words, <code>R</code> needs to know that our package <code>roundR</code> would depend on package <code>magrittr</code> for its functionality to work.</p>
<p>We can fix this by runnin the following <code>usethis</code> evaluation in the console:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_import_from</span>(<span class="st">"magrittr"</span>, <span class="st">"%&gt;%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When asked</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">use_import_from()</span><span class="st">`</span> requires package<span class="sc">-</span>level documentation.</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Would you like to add it now?</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> For sure</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> Not now</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> No way</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>choose the fun option that would add it (i.e.&nbsp;<code>For Sure</code>, <code>Yes</code>, <code>Absolutely</code>, etc). These options change every time you re-run the function code, so read it carefully!</p>
<p>Once you have selected the correct option, we can re-run the <code>CHECK</code>. You will find that there still persists an error in the example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>❯ checking examples ... ERROR</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  Running examples <span class="cf">in</span> ‘roundR<span class="sc">-</span>Ex.R’ failed</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  The error most likely occurred <span class="cf">in</span><span class="sc">:</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="fu">rounder</span>(.) <span class="sc">:</span> could not find <span class="cf">function</span> <span class="st">"rounder"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  Calls<span class="sc">:</span> <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  Execution halted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our package <code>CHECK</code> cannot find function <code>rounder()</code>. That may seem weird, since it is the only function in our package. The thing is - we have not explicitly told <code>roxygen2</code> to <code>export</code> our function, i.e.&nbsp;to make our function available outside of the package namespace. Simply adding <code>@export</code> to the <code>rounder.R</code> file would solve this error:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' @author Gerko Vink \email{g.vink@uu.nl} and Hanne Oberman \email{h.i.oberman@uu.nl}</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' library(magrittr)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try re-running the <code>CHECK</code> - first run <code>devtools::document()</code> - to see if you hit three green check marks (NO errors, warnings and notes). If all is well, you’ll see:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>── R CMD check results ────────────────────────────────────────── roundR <span class="dv">0</span>.<span class="fl">1.0</span> ────</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Duration<span class="sc">:</span> <span class="fl">6.6</span>s</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> errors ✔ <span class="sc">|</span> <span class="dv">0</span> warnings ✔ <span class="sc">|</span> <span class="dv">0</span> notes ✔</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>R CMD check succeeded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="increasing-the-version" class="level4" data-number="6.4.1.6">
<h4 data-number="6.4.1.6" class="anchored" data-anchor-id="increasing-the-version"><span class="header-section-number">6.4.1.6</span> Increasing the version</h4>
<p>Now that we have a working package with a succesfull <code>R CMD check</code>, we might think about updating the version of the package. After all, a lot has changed since the last version got defined at the start of our development journey.</p>
<p>The easiest means to increasing the version to <code>0.2.0</code> (indicating a minor update) is to use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_version</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will be presented with something like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>✔ Setting active project to <span class="st">'/Users/gerko/surfdrive/Werk/GitHub/roundR/roundR'</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Current version is <span class="dv">0</span>.<span class="dv">1</span>.<span class="fl">1.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>What should the new version be? (<span class="dv">0</span> to exit) </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> major <span class="sc">-</span><span class="ot">-&gt;</span> <span class="dv">1</span>.<span class="fl">0.0</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> minor <span class="sc">-</span><span class="ot">-&gt;</span> <span class="dv">0</span>.<span class="fl">2.0</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> patch <span class="sc">-</span><span class="ot">-&gt;</span> <span class="dv">0</span>.<span class="fl">1.2</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span>   dev <span class="sc">-</span><span class="ot">-&gt;</span> <span class="dv">0</span>.<span class="dv">1</span>.<span class="fl">1.9000</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>Selection<span class="sc">:</span> <span class="dv">2</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>✔ Setting Version field <span class="cf">in</span> DESCRIPTION to <span class="st">'0.2.0'</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>There is <span class="dv">1</span> uncommitted file<span class="sc">:</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="er">*</span> <span class="st">'DESCRIPTION'</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>Is it ok to commit it?</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> For sure</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> Negative</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> Nope</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>Selection<span class="sc">:</span> <span class="dv">1</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>✔ Adding files</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>✔ Making a commit with message <span class="st">'Increment version number to 0.2.0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The question <code>Is it ok to commit it?</code> is related to <code>Git</code>. Please click to commit the version increase. For reasons of brevity and simplicity, we will leave a thorough discussion of incremental <code>Git</code> commits for now and demonstrate to use of <code>Git</code> and <code>GitHub</code> at the end of this walkthrough.</p>
</section>
<section id="add-tests" class="level4" data-number="6.4.1.7">
<h4 data-number="6.4.1.7" class="anchored" data-anchor-id="add-tests"><span class="header-section-number">6.4.1.7</span> Add tests</h4>
<p>The next step for a mature package is to include tests. Every function should have functional tests. The <code>testthat</code> package is geared to that. Make sure that you have the <code>rounder.R</code> file open in the <code>Source</code> pane and run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The proper structure for test files has now been created:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>✔ Adding <span class="st">'testthat'</span> to Suggests field <span class="cf">in</span> DESCRIPTION</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>✔ Setting Config<span class="sc">/</span>testthat<span class="sc">/</span>edition field <span class="cf">in</span> DESCRIPTION to <span class="st">'3'</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>✔ Creating <span class="st">'tests/testthat/'</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>✔ Writing <span class="st">'tests/testthat.R'</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>✔ Writing <span class="st">'tests/testthat/test-rounder.R'</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>• Modify <span class="st">'tests/testthat/test-rounder.R'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You are asked to modify the <code>tests/testthat/test-rounder.R</code> file. Replace the example test with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"rounder works"</span>, {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.49</span>, <span class="fl">1.49</span>, <span class="fl">2.49</span>, <span class="fl">3.49</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(A, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(B, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"rounder yields different results than round"</span>, {</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  vec1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.499999999999999999995</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>            <span class="fl">1.499999999999999999995</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">2.499999999999999999995</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">3.499999999999999999995</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> vec1 <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> vec1 <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> vec2 <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> vec2 <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_false</span>(<span class="fu">identical</span>(A, B))</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_false</span>(<span class="fu">identical</span>(C, D))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Click the <code>Test</code> button in the <code>build</code> pane:</p>
<center>
<img src="images/wk6/test.gif" class="img-fluid" style="width:90.0%">
</center>
<p>All test should pass, meaning that your <code>rounder()</code> function yields correct results (test 1) that differ fundamentally from the results obtained with <code>round()</code> (test 2).</p>
<p>If test would fail, you’d be notified. For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"rounder works"</span>, {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>) <span class="sc">%&gt;%</span> <span class="fu">rounder</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(A, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>── Failure: rounder works ──────────────────────────────────────────────────────
`A` not equal to c(4, 3, 2, 1).
4/4 mismatches (average diff: 2)
[1] 1 - 4 == -3
[2] 2 - 3 == -1
[3] 3 - 2 ==  1
[4] 4 - 1 ==  3</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error:
! Test failed</code></pre>
</div>
</div>
<p>Fortunately, our test all passed. Now rerun the <code>R CMD check</code>. If all is well you’ll receive confirmation of a successful check.</p>
</section>
<section id="publishing-to-github" class="level4" data-number="6.4.1.8">
<h4 data-number="6.4.1.8" class="anchored" data-anchor-id="publishing-to-github"><span class="header-section-number">6.4.1.8</span> Publishing to GitHub</h4>
<p><strong>This section assumes that you are logged into your GitHub account. If you have trouble realizing this, <a href="https://docs.github.com/en/desktop/installing-and-configuring-github-desktop/installing-and-authenticating-to-github-desktop">GitHub has a great step-by-step walkthrough</a></strong>.</p>
<p>Let’s publish our <code>R</code>-package to <code>GitHub</code>. To do so, we need to perform two steps. First, we must log (commit) our changes to the <code>Git</code> distributed version control system. This stores the file changes to our own machine. Next we must link our local <code>Git</code> to a remote online repository on <code>GitHub</code>. Luckily, with <code>GitHub Desktop</code>, we can perform all these steps in a single window interface.</p>
Let’s start by adding our <code>R</code>-package to <code>GitHub desktop</code>. Remember that we already started the package in <code>RStudio</code> as a <code>Git</code> repository, so we only have to point <code>GitHub desktop</code> to the correct directory.
<center>
<img src="images/wk6/addgitrepo.gif" class="img-fluid" style="width:90.0%">
</center>
Next, we commit the changes. This means that we save the state of files for a moment in time, so that we can always revert to that state and see how the files changed with respect to the previous state.
<center>
<img src="images/wk6/commit.gif" class="img-fluid" style="width:90.0%">
</center>
<p>Naturally, you would not only do this at the start (when <code>RStudio</code> created the <code>Git</code> repository) and end (when we have a working package), but at regular and informative intervals. For example, when you add a function, a test, a help file, a license, etcetera.</p>
Now that we have commited our package, we can publish it on <code>GitHub</code>.
<center>
<img src="images/wk6/publish_gh.gif" class="img-fluid" style="width:90.0%">
</center>
Try your online <code>GitHub</code> repositories at <a href="https://github.com">https://github.com</a>. You will see your package there and that the license is automatically recognized. You will also see that you are in the <code>main</code> branch. By default, that will be the live version of your package. Now that your package is live, it would be nice to add a <code>Readme</code> file that informs visitors to your repository. But we will extend our workflow with a good behaviour: not working in the <code>main</code> branch. We would not want to accidentally overwrite or break the functionality of our package, just because we were working in the same branch. So let’s add a <code>Readme</code> to a new <code>development</code> branch.
<center>
<img src="images/wk6/addreadme.gif" class="img-fluid" style="width:90.0%">
</center>
When we commit the new <code>Readme</code> file to the <code>development</code> branch, a new window opens to propose the <code>pull request</code> (PR). The PR is nothing more than a request to the package developers to pull your proposed changes into (usually) the <code>main</code> branch of the software. Since we are the developers, we have to both create and accept the PR.
<center>
<img src="images/wk6/openpr.gif" class="img-fluid" style="width:90.0%">
</center>
<p>It is good procedure to write an informative PR message, usually outlining the nature and rationale of the changes. I also demonstrate how to accept a PR, thereby approving the changes per file (only one now) and signing it with my initials. I cannot formally <em>approve</em> my own PR, since that would leave great opportunity for subjectivity or error. Proper procedure would be to have someone else check and approve your changes.</p>
<center>
<img src="images/wk6/pullrequest.gif" class="img-fluid" style="width:90.0%">
</center>
<p>When you go back to <code>GitHub desktop</code> and <code>fetch</code> the changes on teh remote (that would be GitHub online), you will see that you have now access to the <code>readme</code> file and the <code>development</code> branch.</p>
</section>
<section id="registering-a-doi" class="level4" data-number="6.4.1.9">
<h4 data-number="6.4.1.9" class="anchored" data-anchor-id="registering-a-doi"><span class="header-section-number">6.4.1.9</span> Registering a <code>DOI</code></h4>
<p>Now that we have a proper and open source package online and the world as our user base, it would be wise to allow for proper referencing of our package.</p>
<p><code>GitHub</code> and <code>Zenodo</code> have paired to facilitate this procedure. If you link your <code>Zenodo</code> account to <code>GitHub</code>, <a href="https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content">as outlined here</a>, you only have to click, copy and paste to fully make your <code>GitHub</code> repo citeable.</p>
<center>
<img src="images/wk6/doi.gif" class="img-fluid" style="width:90.0%">
</center>
</section>
<section id="add-citation" class="level4" data-number="6.4.1.10">
<h4 data-number="6.4.1.10" class="anchored" data-anchor-id="add-citation"><span class="header-section-number">6.4.1.10</span> Add citation</h4>
<p><code>Zenodo</code> prepares the repository citation for us. We can simply grab the info, change our personal information and submit it to <code>GitHub</code>.</p>
<center>
<img src="images/wk6/citation.gif" class="img-fluid" style="width:90.0%">
</center>
<p>The final step before we would put our package <em>out there</em> is to notify how users can refer to our package. Run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_citation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which will create the necessary citation files for modification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>✔ Creating <span class="st">'inst/'</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>✔ Writing <span class="st">'inst/CITATION'</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>• Modify <span class="st">'inst/CITATION'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now simply grab the text and/or <code>bibtex</code> citation from <code>GitHub</code> and paste it into the <code>CITATION</code> file. The citation info cf.&nbsp;<code>R</code>-packages could be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citHeader</span>(<span class="st">"To cite roundR in publications use:"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">citEntry</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">entry    =</span> <span class="st">"Manual"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title    =</span> <span class="st">"gerkovink/roundR: Version 0.2.0 - First release"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">author   =</span> <span class="st">"Gerko Vink and Hanne Oberman"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">year     =</span> <span class="st">"2023"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">doi      =</span> <span class="st">"10.5281/zenodo.7668889"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"github.com/gerkovink/roundR"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">textVersion =</span> <span class="fu">paste</span>(</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="st">"Vink, G and Oberman, H.I. (2023). gerkovink/roundR: Version 0.2.0 - First release (Version v0.2.0) [Computer software]. https://doi.org/10.5281/zenodo.7668889"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modify this to your name, DOI and repository url and paste it into the <code>CITATION</code> file.</p>
<center>
<img src="images/wk6/use_citation.gif" class="img-fluid" style="width:90.0%">
</center>
</section>
</section>
</section>
<section id="installing-your-own-package-from-github" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="installing-your-own-package-from-github"><span class="header-section-number">6.5</span> Installing your own package from GitHub</h2>
<p>Go to <code>GitHub desktop</code>, and commit and push the changes to <code>GitHub</code>. Then run the following code block:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"gerkovink/roundR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where you replace <code>"gerkovink/roundR"</code> with your <code>GitHub</code> handle and repository name.</p>
<center>
<img src="images/wk6/install_github.gif" class="img-fluid" style="width:90.0%">
</center>
</section>
<section id="advanced-topics" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="advanced-topics"><span class="header-section-number">6.6</span> Advanced topics</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img src="images/wk6/hex.png" class="img-fluid" style="width:90.0%"></p>
</div><div class="column" style="width:70%;">
<p>Potential next steps include:</p>
<ul>
<li>Creating package documentation (e.g.&nbsp;vignettes)</li>
<li>Creating a hex logo (e.g.&nbsp;with <a href="https://connect.thinkr.fr/hexmake/"><code>hexmake</code></a>)</li>
<li>Creating a package website (e.g.&nbsp;with <a href="https://pkgdown.r-lib.org/"><code>pkgdown</code></a>)</li>
<li>Checking the FAIR-ness of your package (e.g.&nbsp;with <a href="https://pypi.org/project/howfairis/"><code>howfairis</code></a>, or <a href="https://bestpractices.coreinfrastructure.org/en">BadgeApp</a>)</li>
<li>Checking the code coverage of your package (e.g.&nbsp;with <a href="https://about.codecov.io/">Codecov</a>)</li>
<li>Maintaining the package (e.g.&nbsp;with <a href="https://docs.github.com/en/issues/tracking-your-work-with-issues">GitHub issues</a>)</li>
<li>Maintaining contributions (e.g.&nbsp;with <a href="https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-code-of-conduct-to-your-project">a code of conduct</a>)</li>
</ul>
</div>
</div>


</section>

</main> <!-- /main -->
<script>
var custom_title = document.querySelectorAll('.custom .theorem-title');

for (let i = 0; i < custom_title.length; i++ ) {
   var mod_name = custom_title[i].innerHTML;
   custom_title[i].innerHTML = mod_name.replace("Example", "Exercise");
};
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week 5.html" class="pagination-link" aria-label="Developer Portfolios">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Developer Portfolios</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./story.html" class="pagination-link" aria-label="Contributors">
        <span class="nav-page-text">Contributors</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gerkovink/markup/edit/book/week 6.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gerkovink/markup/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>